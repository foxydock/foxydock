include snippets/example/by_version/v3/by_app/by_name/fdn/app/common/mix_server_no_location_setting.conf;
client_max_body_size 32m;

include snippets/example/by_version/v3/by_context/http/server/leaf_location_jump_index_html.conf;
location = /index.html {
    set $fdn_app_name "clash-webui";
    include snippets/example/by_version/v3/by_app/by_name/fdn/app/common/location/mix_common_setting.conf;
    proxy_pass $fdn_app_upstream;
}

location /assets/ {
    set $fdn_app_name "clash-webui";
    include snippets/example/by_version/v3/by_app/by_name/fdn/app/common/location/mix_common_setting.conf;
    proxy_pass $fdn_app_upstream;
}

location ~* ^/.*\.(js|css|htm|html|bmp|png|jpg|jpeg|svg|ico|webmanifest)$ {
    set $fdn_app_name "clash-webui";
    include snippets/example/by_version/v3/by_app/by_name/fdn/app/common/location/mix_common_setting.conf;
    proxy_pass $fdn_app_upstream;
}

location / {
    set $fdn_app_name "clash-webui";
    if ( $http_authorization != '' ) {
        set $fdn_app_name "mihomo";
    }

    if ( $http_upgrade = "websocket" ) {
        set $fdn_app_name "mihomo";
    }

    include snippets/example/by_version/v3/by_app/by_name/fdn/app/common/location/mix_common_setting.conf;
    proxy_pass $fdn_app_upstream;
}
